{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useEffect, useState } from \"react\";\nimport \"./style.css\"; // reactstrap components\n\nimport { Button, Card, CardHeader, CardBody, FormGroup, Form, Input, Container, Row, Col, Badge, Modal, ModalHeader, ModalBody, ModalFooter, Label, CardTitle, CardText, CardFooter, CardImg } from \"reactstrap\"; // layout for this page\n\nimport Admin from \"layouts/Admin.js\"; // core components\n\nimport HeaderUser from \"components/Headers/HeaderUser.js\";\nimport DataTable from \"react-data-table-component\";\nimport axios from \"axios\";\nimport Cookies from \"universal-cookie\";\nimport Swal from \"sweetalert2\";\nimport Select from \"react-select\";\nimport PlaceholderImage from \"../../assets/img/icons/placeholder.png\";\n\nconst User = () => {\n  const cookies = new Cookies();\n  const {\n    0: modal,\n    1: setModal\n  } = useState(false);\n  const {\n    0: idEvent,\n    1: setIdEvent\n  } = useState(\"\");\n  const {\n    0: token,\n    1: setToken\n  } = useState(\"\");\n  const {\n    0: dataEvent,\n    1: setDataEvent\n  } = useState(null);\n  const {\n    0: eventOption,\n    1: setEventOption\n  } = useState([]);\n  const {\n    0: idEventActive,\n    1: setIdEventActive\n  } = useState(false);\n  const {\n    0: tokenActive,\n    1: setTokenActive\n  } = useState(false);\n  const {\n    0: dataKandidat,\n    1: setDataKandidat\n  } = useState([]);\n  const {\n    0: kandidatDipilih,\n    1: setKandidatDipilih\n  } = useState([]);\n\n  let handleSubmitEvent = () => {\n    setIdEventActive(true);\n  };\n\n  let handleSubmitToken = async () => {\n    const data = {\n      token\n    };\n    await axios.post(`${process.env.NEXT_PUBLIC_URL}/token/check-token/${idEvent}`, data, {\n      headers: {\n        Authorization: `Bearer ${cookies.get(\"token\")}`\n      }\n    }).then(res => {\n      setTokenActive(true);\n      setDataKandidat(res.data.data.content);\n    }).catch(e => {\n      console.log(e);\n\n      if (e.response.data.message) {\n        Swal.fire({\n          icon: \"error\",\n          title: \"Terjadi Kesalahan!\",\n          text: e.response.data.message\n        });\n      } else {\n        Swal.fire({\n          icon: \"error\",\n          title: \"Terjadi Kesalahan!\",\n          text: e\n        });\n      }\n    });\n  };\n\n  let handleVote = async () => {\n    const data = {\n      token,\n      candidate_id: kandidatDipilih\n    };\n    await axios.post(`${process.env.NEXT_PUBLIC_URL}/vote/${idEvent}`, data, {\n      headers: {\n        Authorization: `Bearer ${cookies.get(\"token\")}`\n      }\n    }).then(res => {\n      Swal.fire({\n        icon: \"success\",\n        title: \"Berhasil\",\n        text: \"Vote Berhasil\",\n        timer: 2000\n      });\n      setTokenActive(false);\n      setKandidatDipilih([]);\n      setToken(\"\");\n    }).catch(e => {\n      var _e$response, _e$response$data;\n\n      console.log(e);\n\n      if (e !== null && e !== void 0 && (_e$response = e.response) !== null && _e$response !== void 0 && (_e$response$data = _e$response.data) !== null && _e$response$data !== void 0 && _e$response$data.message) {\n        Swal.fire({\n          icon: \"error\",\n          title: \"Terjadi Kesalahan!\",\n          text: e.response.data.message\n        });\n      } else {\n        Swal.fire({\n          icon: \"error\",\n          title: \"Terjadi Kesalahan!\",\n          text: e\n        });\n      }\n    });\n  };\n\n  let hanldePilihKandidat = id => {\n    if (!kandidatDipilih.includes(id)) {\n      setKandidatDipilih([...kandidatDipilih, id]);\n    } else {\n      let newKandidat = kandidatDipilih.filter(item => item !== id);\n      setKandidatDipilih(newKandidat);\n    }\n  };\n\n  let handleChangeEvent = e => {\n    let data = e.data;\n    console.log(data);\n    setIdEvent(data.id);\n    setDataEvent(data);\n  };\n\n  let getOptionEvent = async () => {\n    const {\n      data: res\n    } = await axios.get(`${process.env.NEXT_PUBLIC_URL}/event/list/option`);\n    setEventOption(res);\n  };\n\n  useEffect(() => {\n    getOptionEvent();\n  }, []);\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(HeaderUser, {}), /*#__PURE__*/_jsx(Container, {\n      className: \"mt-4\",\n      fluid: true,\n      children: /*#__PURE__*/_jsx(Row, {\n        children: /*#__PURE__*/_jsx(Col, {\n          children: /*#__PURE__*/_jsx(Card, {\n            className: \"shadow\",\n            children: /*#__PURE__*/_jsxs(CardBody, {\n              children: [idEventActive === false ? /*#__PURE__*/_jsx(Form, {\n                children: /*#__PURE__*/_jsxs(Row, {\n                  className: \"row-cols-lg-auto g-3 align-items-end\",\n                  children: [/*#__PURE__*/_jsxs(Col, {\n                    children: [/*#__PURE__*/_jsx(Label, {\n                      className: \"visually-hidden\",\n                      for: \"examplePassword\",\n                      children: \"Pilih Event\"\n                    }), /*#__PURE__*/_jsx(Select, {\n                      options: eventOption,\n                      onChange: e => handleChangeEvent(e)\n                    })]\n                  }), /*#__PURE__*/_jsxs(Col, {\n                    className: \"align-items-center\",\n                    children: [/*#__PURE__*/_jsx(Label, {\n                      className: \"visually-hidden\",\n                      for: \"examplePassword\"\n                    }), /*#__PURE__*/_jsx(Button, {\n                      color: \"primary\",\n                      onClick: () => handleSubmitEvent(),\n                      children: \"Submit\"\n                    })]\n                  })]\n                })\n              }) : null, idEventActive ? /*#__PURE__*/_jsx(Form, {\n                children: /*#__PURE__*/_jsxs(Row, {\n                  className: \"row-cols-lg-auto g-3 align-items-end\",\n                  children: [/*#__PURE__*/_jsxs(Col, {\n                    children: [/*#__PURE__*/_jsx(Label, {\n                      className: \"visually-hidden\",\n                      for: \"examplePassword\",\n                      children: \"Token\"\n                    }), /*#__PURE__*/_jsx(Input, {\n                      id: \"token\",\n                      disabled: tokenActive,\n                      name: \"token\",\n                      value: token,\n                      placeholder: \"masukkan token\",\n                      onChange: e => setToken(e.target.value)\n                    })]\n                  }), /*#__PURE__*/_jsxs(Col, {\n                    className: \"align-items-center\",\n                    children: [/*#__PURE__*/_jsx(Label, {\n                      className: \"visually-hidden\",\n                      for: \"examplePassword\",\n                      children: \" \"\n                    }), /*#__PURE__*/_jsx(Button, {\n                      color: \"primary\",\n                      onClick: () => handleSubmitToken(),\n                      disabled: tokenActive,\n                      children: \"Submit\"\n                    })]\n                  })]\n                })\n              }) : null, tokenActive ? /*#__PURE__*/_jsxs(_Fragment, {\n                children: [/*#__PURE__*/_jsx(\"div\", {\n                  className: \"row justify-content-center mt-5\",\n                  children: /*#__PURE__*/_jsxs(\"h2\", {\n                    children: [\"Jumlah Vote : \", kandidatDipilih.length, \"/\", dataEvent === null || dataEvent === void 0 ? void 0 : dataEvent.quota]\n                  })\n                }), kandidatDipilih.length === (dataEvent === null || dataEvent === void 0 ? void 0 : dataEvent.quota) ? /*#__PURE__*/_jsx(Button, {\n                  className: \"mt-5 my-2\",\n                  onClick: () => handleVote(),\n                  color: \"success\",\n                  style: {\n                    width: \"100%\"\n                  },\n                  children: \"Vote\"\n                }) : null, /*#__PURE__*/_jsx(\"div\", {\n                  class: \"row row-cols-1 row-cols-md-5 g-2 justify-content-center\",\n                  children: dataKandidat.map(item => {\n                    return /*#__PURE__*/_jsxs(Card, {\n                      className: \"my-2 mr-1\",\n                      color: \"dark\",\n                      outline: true,\n                      children: [/*#__PURE__*/_jsx(CardHeader, {\n                        children: /*#__PURE__*/_jsxs(\"div\", {\n                          className: \"row\",\n                          children: [/*#__PURE__*/_jsx(\"div\", {\n                            className: \"col-sm-10\",\n                            children: item.candidate_name\n                          }), /*#__PURE__*/_jsx(\"div\", {\n                            className: \"col-sm-2 justify-content-center\",\n                            children: kandidatDipilih.includes(item.id) ? /*#__PURE__*/_jsx(\"div\", {\n                              style: {\n                                backgroundColor: \"#5cb85c\",\n                                borderRadius: \"100%\",\n                                height: \"30px\",\n                                width: \"30px\"\n                              },\n                              className: \" d-flex align-items-center justify-content-center\",\n                              children: /*#__PURE__*/_jsx(\"i\", {\n                                class: \"fa fa-check\",\n                                style: {\n                                  color: \"white\"\n                                },\n                                \"aria-hidden\": \"true\"\n                              })\n                            }) : null\n                          })]\n                        })\n                      }), (dataEvent === null || dataEvent === void 0 ? void 0 : dataEvent.show_photo) === 1 ? /*#__PURE__*/_jsx(CardImg, {\n                        alt: \"Card image cap\",\n                        src: item.photo_url !== null ? item.photo_url : PlaceholderImage,\n                        top: true,\n                        width: \"100%\",\n                        height: \"350px\",\n                        style: {\n                          objectFit: \"cover\"\n                        }\n                      }) : \"\", /*#__PURE__*/_jsxs(CardBody, {\n                        children: [/*#__PURE__*/_jsx(CardTitle, {\n                          tag: \"h5\"\n                        }), /*#__PURE__*/_jsx(CardText, {}), /*#__PURE__*/_jsx(\"div\", {\n                          className: \"d-flex justify-content-between\",\n                          children: /*#__PURE__*/_jsx(Button, {\n                            onClick: () => hanldePilihKandidat(item.id),\n                            color: \"primary\",\n                            disabled: kandidatDipilih.length === (dataEvent === null || dataEvent === void 0 ? void 0 : dataEvent.quota) && !kandidatDipilih.includes(item.id),\n                            style: {\n                              width: \"100%\"\n                            },\n                            children: \"Pilih\"\n                          })\n                        })]\n                      })]\n                    });\n                  })\n                })]\n              }) : null, kandidatDipilih.length === (dataEvent === null || dataEvent === void 0 ? void 0 : dataEvent.quota) ? /*#__PURE__*/_jsx(Button, {\n                className: \"mt-5 my-2\",\n                onClick: () => handleVote(),\n                color: \"success\",\n                style: {\n                  width: \"100%\"\n                },\n                children: \"Vote\"\n              }) : null]\n            })\n          })\n        })\n      })\n    })]\n  });\n}; // User.layout = Admin;\n\n\nexport default User;","map":null,"metadata":{},"sourceType":"module"}