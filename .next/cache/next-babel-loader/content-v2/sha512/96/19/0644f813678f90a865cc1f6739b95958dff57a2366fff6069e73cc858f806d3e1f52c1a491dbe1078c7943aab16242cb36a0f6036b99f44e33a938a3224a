{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"D:/CBA/E-Voting/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/CBA/E-Voting/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React, { useEffect, useState } from \"react\";\nimport { useRouter } from \"next/router\";\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter, Form, FormGroup, Label, Input, Card, CardBody } from \"reactstrap\";\nimport DataTable from \"react-data-table-component\";\nimport axios from \"axios\";\nimport Swal from \"sweetalert2\";\nimport Cookies from \"universal-cookie\";\n\nvar TableCalon = function TableCalon() {\n  var _useState = useState(false),\n      modal = _useState[0],\n      setModal = _useState[1];\n\n  var _useState2 = useState(null),\n      selectedData = _useState2[0],\n      setSelectedData = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      namaKandidat = _useState3[0],\n      setNamaKandidat = _useState3[1];\n\n  var _useState4 = useState(null),\n      fotoKandidat = _useState4[0],\n      setfotoKandidat = _useState4[1];\n\n  var _useState5 = useState([]),\n      dataCandidate = _useState5[0],\n      setCandidateDetail = _useState5[1];\n\n  var _useState6 = useState(\"create\"),\n      action = _useState6[0],\n      setAction = _useState6[1];\n\n  var _useState7 = useState(false),\n      loading = _useState7[0],\n      setLoading = _useState7[1];\n\n  var _useState8 = useState(10),\n      perPage = _useState8[0],\n      setPerPage = _useState8[1];\n\n  var _useState9 = useState(1),\n      currentPage = _useState9[0],\n      setCurrentPage = _useState9[1];\n\n  var _useState10 = useState(0),\n      totalRows = _useState10[0],\n      setTotalRows = _useState10[1];\n\n  var _useState11 = useState(null),\n      id = _useState11[0],\n      setId = _useState11[1];\n\n  var cookies = new Cookies();\n  useEffect(function () {\n    getCandidate();\n  }, []);\n  var router = useRouter();\n  var eventId = router.query.eventId;\n\n  var getCandidate = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _yield$axios$get, res;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setLoading(true);\n              _context.next = 3;\n              return axios.get(\"\".concat(process.env.NEXT_PUBLIC_URL, \"/candidate/\").concat(eventId, \"/?page=\").concat(currentPage, \"&size=\").concat(perPage));\n\n            case 3:\n              _yield$axios$get = _context.sent;\n              res = _yield$axios$get.data;\n              setTotalRows(res.data.totalData);\n              setCandidateDetail(res.data.content);\n              setLoading(false);\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function getCandidate() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var toggle = function toggle() {\n    return setModal(!modal);\n  };\n\n  var columnCalon = [{\n    name: \"Nama\",\n    selector: function selector(row) {\n      return row.candidate_name;\n    }\n  }, {\n    name: \"Foto\",\n    cell: function cell(row) {\n      return /*#__PURE__*/_jsx(\"img\", {\n        src: row.photo_url,\n        alt: row.photo_url,\n        style: {\n          width: \"50px\"\n        }\n      });\n    }\n  }, {\n    name: \"Action\",\n    cell: function cell(row) {\n      return /*#__PURE__*/_jsxs(_Fragment, {\n        children: [/*#__PURE__*/_jsx(Button, {\n          onClick: function onClick() {\n            return handleEditForm(row.id);\n          },\n          color: \"primary\",\n          size: \"sm\",\n          children: \"Edit\"\n        }), /*#__PURE__*/_jsx(Button, {\n          onClick: function onClick() {\n            return handleDelete(row.id);\n          },\n          color: \"danger\",\n          size: \"sm\",\n          children: \"Hapus\"\n        })]\n      });\n    }\n  }];\n\n  var handleTambah = function handleTambah() {\n    setAction(\"create\");\n    setModal(true);\n  };\n\n  var handleEditForm = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id) {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              setAction(\"update\");\n              _context2.next = 3;\n              return axios.get(\"\".concat(process.env.NEXT_PUBLIC_URL, \"/candidate/detail/\").concat(id), {\n                headers: {\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \".concat(cookies.get(\"token\"))\n                }\n              }).then(function (res) {\n                var data = res.data.data;\n                setNamaKandidat(data.candidate_name);\n                setfotoKandidat(data.photo_url);\n                setModal(true);\n              })[\"catch\"](function (e) {\n                Swal.fire({\n                  icon: \"error\",\n                  title: \"Terjadi Kesalahan!\",\n                  text: e\n                });\n              });\n\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleEditForm(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleDelete = function handleDelete(id) {\n    Swal.fire({\n      title: \"Anda Yakin ?\",\n      text: \"Data yang telah dihapus tidak dapat dikembalikan!\",\n      icon: \"warning\",\n      showCancelButton: true,\n      confirmButtonColor: \"#3085d6\",\n      cancelButtonColor: \"#d33\",\n      confirmButtonText: \"Yakin!\"\n    }).then(function (result) {\n      if (result.isConfirmed) {\n        axios[\"delete\"](\"\".concat(process.env.NEXT_PUBLIC_URL, \"/candidate/\").concat(id, \" \"), {\n          headers: {\n            Authorization: \"Bearer \".concat(cookies.get(\"token\"))\n          }\n        }).then(function (res) {\n          Swal.fire({\n            icon: \"success\",\n            title: \"Berhasil\",\n            text: \"Data Berhasil Dihapus !\"\n          });\n          getCandidate();\n        });\n      }\n    });\n  };\n\n  var handleSubmitEvent = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id) {\n      var formData;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              formData = new FormData();\n              formData.append(\"candidate_name\", namaKandidat);\n              formData.append(\"image\", fotoKandidat);\n\n              if (!(action === \"create\")) {\n                _context3.next = 6;\n                break;\n              }\n\n              _context3.next = 6;\n              return axios.post(\"\".concat(process.env.NEXT_PUBLIC_URL, \"/candidate/\").concat(eventId), formData, {\n                headers: {\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \".concat(cookies.get(\"token\"))\n                }\n              }).then(function (res) {\n                Swal.fire({\n                  icon: \"success\",\n                  title: \"Berhasil\",\n                  text: \"Data Berhasil Disimpan !\"\n                });\n                setModal(false);\n                getCandidate();\n              })[\"catch\"](function (e) {\n                console.log(e);\n\n                if (e.response.data.error_messages) {\n                  Swal.fire({\n                    icon: \"error\",\n                    title: \"Terjadi Kesalahan!\",\n                    text: e.response.data.error_messages[0].msg\n                  });\n                } else {\n                  Swal.fire({\n                    icon: \"error\",\n                    title: \"Terjadi Kesalahan!\",\n                    text: e\n                  });\n                }\n              });\n\n            case 6:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function handleSubmitEvent(_x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var onClosedModal = function onClosedModal() {\n    setId(null);\n    setNamaKandidat(\"\");\n    setfotoKandidat(\"\");\n  };\n\n  var handleChange = function handleChange(e, field) {\n    if (field === \"kandidat\") {\n      setNamaKandidat(e.target.value);\n    } else if (field === \"foto\") {\n      setfotoKandidat(e.target.files[0]);\n    } else {\n      Swal.fire({\n        icon: \"error\",\n        title: \"Oops...\",\n        text: \"Something went wrong!\"\n      });\n    }\n  };\n\n  var handlePageChange = function handlePageChange(page) {\n    setCurrentPage(page);\n  };\n\n  var handlePerRowsChange = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(newPerPage, page) {\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              setPerPage(newPerPage);\n\n            case 1:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function handlePerRowsChange(_x3, _x4) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(Card, {\n      className: \"mt-2 mb-2\",\n      color: \"secondary\",\n      children: /*#__PURE__*/_jsx(CardBody, {\n        children: /*#__PURE__*/_jsx(Button, {\n          color: \"primary\",\n          onClick: function onClick() {\n            return handleTambah(true);\n          },\n          children: \"Tambah\"\n        })\n      })\n    }), /*#__PURE__*/_jsx(DataTable, {\n      columns: columnCalon,\n      data: dataCandidate,\n      pagination: true,\n      progressPending: loading,\n      paginationTotalRows: totalRows,\n      paginationDefaultPage: currentPage,\n      onChangeRowsPerPage: handlePerRowsChange,\n      onChangePage: handlePageChange\n    }), /*#__PURE__*/_jsxs(Modal, {\n      isOpen: modal,\n      toggle: toggle,\n      onClosed: onClosedModal,\n      children: [/*#__PURE__*/_jsx(ModalHeader, {\n        toggle: toggle,\n        children: \"Modal title\"\n      }), /*#__PURE__*/_jsx(ModalBody, {\n        children: /*#__PURE__*/_jsxs(Form, {\n          children: [/*#__PURE__*/_jsxs(FormGroup, {\n            children: [/*#__PURE__*/_jsx(Label, {\n              \"for\": \"namaKandidat\",\n              children: \"Event\"\n            }), /*#__PURE__*/_jsx(Input, {\n              id: \"namaKandidat\",\n              name: \"nama\",\n              placeholder: \"Nama Calon\",\n              type: \"text\",\n              value: namaKandidat,\n              onChange: function onChange(e) {\n                return handleChange(e, \"kandidat\");\n              }\n            })]\n          }), /*#__PURE__*/_jsxs(FormGroup, {\n            children: [/*#__PURE__*/_jsx(Label, {\n              \"for\": \"fotoKandidat\",\n              children: \"Foto Calon\"\n            }), /*#__PURE__*/_jsx(Input, {\n              id: \"fotoKandidat\",\n              name: \"foto\",\n              type: \"file\",\n              onChange: function onChange(e) {\n                return handleChange(e, \"foto\");\n              }\n            }), /*#__PURE__*/_jsx(\"p\", {\n              children: fotoKandidat\n            })]\n          })]\n        })\n      }), /*#__PURE__*/_jsx(ModalFooter, {\n        children: /*#__PURE__*/_jsx(Button, {\n          color: \"primary\",\n          onClick: function onClick() {\n            return handleSubmitEvent();\n          },\n          children: \"Simpan\"\n        })\n      })]\n    })]\n  });\n};\n\nexport default TableCalon;","map":null,"metadata":{},"sourceType":"module"}