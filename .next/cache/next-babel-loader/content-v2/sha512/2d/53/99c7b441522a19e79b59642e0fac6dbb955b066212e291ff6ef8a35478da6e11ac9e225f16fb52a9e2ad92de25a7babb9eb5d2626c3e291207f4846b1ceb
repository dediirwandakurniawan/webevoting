{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _toConsumableArray from \"D:/Project/eVoting_FE/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"D:/Project/eVoting_FE/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/Project/eVoting_FE/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React, { useEffect, useState } from \"react\";\nimport \"./style.css\"; // reactstrap components\n\nimport { Button, Card, CardHeader, CardBody, FormGroup, Form, Input, Container, Row, Col, Badge, Modal, ModalHeader, ModalBody, ModalFooter, Label, CardTitle, CardText, CardFooter, CardImg } from \"reactstrap\"; // layout for this page\n\nimport Admin from \"layouts/Admin.js\"; // core components\n\nimport HeaderUser from \"components/Headers/HeaderUser.js\";\nimport DataTable from \"react-data-table-component\";\nimport axios from \"axios\";\nimport Cookies from \"universal-cookie\";\nimport Swal from \"sweetalert2\";\nimport Select from \"react-select\";\nimport PlaceholderImage from \"../../assets/img/icons/placeholder.png\";\n\nvar User = function User() {\n  var cookies = new Cookies();\n\n  var _useState = useState(false),\n      modal = _useState[0],\n      setModal = _useState[1];\n\n  var _useState2 = useState(\"\"),\n      idEvent = _useState2[0],\n      setIdEvent = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      token = _useState3[0],\n      setToken = _useState3[1];\n\n  var _useState4 = useState(null),\n      dataEvent = _useState4[0],\n      setDataEvent = _useState4[1];\n\n  var _useState5 = useState([]),\n      eventOption = _useState5[0],\n      setEventOption = _useState5[1];\n\n  var _useState6 = useState(false),\n      idEventActive = _useState6[0],\n      setIdEventActive = _useState6[1];\n\n  var _useState7 = useState(false),\n      tokenActive = _useState7[0],\n      setTokenActive = _useState7[1];\n\n  var _useState8 = useState([]),\n      dataKandidat = _useState8[0],\n      setDataKandidat = _useState8[1];\n\n  var _useState9 = useState([]),\n      kandidatDipilih = _useState9[0],\n      setKandidatDipilih = _useState9[1];\n\n  var handleSubmitEvent = function handleSubmitEvent() {\n    setIdEventActive(true);\n  };\n\n  var handleSubmitToken = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var data;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              data = {\n                token: token\n              };\n              _context.next = 3;\n              return axios.post(\"\".concat(process.env.NEXT_PUBLIC_URL, \"/token/check-token/\").concat(idEvent), data, {\n                headers: {\n                  Authorization: \"Bearer \".concat(cookies.get(\"token\"))\n                }\n              }).then(function (res) {\n                setTokenActive(true);\n                setDataKandidat(res.data.data.content);\n              })[\"catch\"](function (e) {\n                console.log(e);\n\n                if (e.response.data.message) {\n                  Swal.fire({\n                    icon: \"error\",\n                    title: \"Terjadi Kesalahan!\",\n                    text: e.response.data.message\n                  });\n                } else {\n                  Swal.fire({\n                    icon: \"error\",\n                    title: \"Terjadi Kesalahan!\",\n                    text: e\n                  });\n                }\n              });\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleSubmitToken() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var handleVote = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var data;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              data = {\n                token: token,\n                candidate_id: kandidatDipilih\n              };\n              _context2.next = 3;\n              return axios.post(\"\".concat(process.env.NEXT_PUBLIC_URL, \"/vote/\").concat(idEvent), data, {\n                headers: {\n                  Authorization: \"Bearer \".concat(cookies.get(\"token\"))\n                }\n              }).then(function (res) {\n                Swal.fire({\n                  icon: \"success\",\n                  title: \"Berhasil\",\n                  text: \"Vote Berhasil\",\n                  timer: 2000\n                });\n                setTokenActive(false);\n                setKandidatDipilih([]);\n                setToken(\"\");\n              })[\"catch\"](function (e) {\n                var _e$response, _e$response$data;\n\n                console.log(e);\n\n                if (e !== null && e !== void 0 && (_e$response = e.response) !== null && _e$response !== void 0 && (_e$response$data = _e$response.data) !== null && _e$response$data !== void 0 && _e$response$data.message) {\n                  Swal.fire({\n                    icon: \"error\",\n                    title: \"Terjadi Kesalahan!\",\n                    text: e.response.data.message\n                  });\n                } else {\n                  Swal.fire({\n                    icon: \"error\",\n                    title: \"Terjadi Kesalahan!\",\n                    text: e\n                  });\n                }\n              });\n\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleVote() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var hanldePilihKandidat = function hanldePilihKandidat(id) {\n    if (!kandidatDipilih.includes(id)) {\n      setKandidatDipilih([].concat(_toConsumableArray(kandidatDipilih), [id]));\n    } else {\n      var newKandidat = kandidatDipilih.filter(function (item) {\n        return item !== id;\n      });\n      setKandidatDipilih(newKandidat);\n    }\n  };\n\n  var handleChangeEvent = function handleChangeEvent(e) {\n    var data = e.data;\n    console.log(data, \"ini data\");\n    setIdEvent(data.id);\n    setDataEvent(data);\n  };\n\n  var getOptionEvent = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var _yield$axios$get, res;\n\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return axios.get(\"\".concat(process.env.NEXT_PUBLIC_URL, \"/event/list/option\"));\n\n            case 2:\n              _yield$axios$get = _context3.sent;\n              res = _yield$axios$get.data;\n              setEventOption(res);\n\n            case 5:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function getOptionEvent() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    getOptionEvent();\n  }, []);\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(HeaderUser, {}), /*#__PURE__*/_jsx(Container, {\n      className: \"mt-4\",\n      fluid: true,\n      children: /*#__PURE__*/_jsx(Row, {\n        children: /*#__PURE__*/_jsx(Col, {\n          children: /*#__PURE__*/_jsxs(Card, {\n            className: \"shadow\",\n            children: [/*#__PURE__*/_jsx(CardHeader, {\n              className: \"bg-transparent\",\n              children: /*#__PURE__*/_jsx(\"h3\", {\n                className: \"mb-0\",\n                children: dataEvent !== null ? dataEvent === null || dataEvent === void 0 ? void 0 : dataEvent.event_name : \"Event\"\n              })\n            }), /*#__PURE__*/_jsxs(CardBody, {\n              children: [idEventActive === false ? /*#__PURE__*/_jsx(Form, {\n                children: /*#__PURE__*/_jsxs(Row, {\n                  className: \"row-cols-lg-auto g-3 align-items-end\",\n                  children: [/*#__PURE__*/_jsxs(Col, {\n                    children: [/*#__PURE__*/_jsx(Label, {\n                      className: \"visually-hidden\",\n                      \"for\": \"examplePassword\",\n                      children: \"Pilih Event\"\n                    }), /*#__PURE__*/_jsx(Select, {\n                      options: eventOption,\n                      onChange: function onChange(e) {\n                        return handleChangeEvent(e);\n                      }\n                    })]\n                  }), /*#__PURE__*/_jsxs(Col, {\n                    className: \"align-items-center\",\n                    children: [/*#__PURE__*/_jsx(Label, {\n                      className: \"visually-hidden\",\n                      \"for\": \"examplePassword\"\n                    }), /*#__PURE__*/_jsx(Button, {\n                      color: \"primary\",\n                      onClick: function onClick() {\n                        return handleSubmitEvent();\n                      },\n                      children: \"Submit\"\n                    })]\n                  })]\n                })\n              }) : null, idEventActive ? /*#__PURE__*/_jsx(Form, {\n                children: /*#__PURE__*/_jsxs(Row, {\n                  className: \"row-cols-lg-auto g-3 align-items-end\",\n                  children: [/*#__PURE__*/_jsxs(Col, {\n                    children: [/*#__PURE__*/_jsx(Label, {\n                      className: \"visually-hidden\",\n                      \"for\": \"examplePassword\",\n                      children: \"Token\"\n                    }), /*#__PURE__*/_jsx(Input, {\n                      id: \"token\",\n                      disabled: tokenActive,\n                      name: \"token\",\n                      value: token,\n                      placeholder: \"masukkan token\",\n                      onChange: function onChange(e) {\n                        return setToken(e.target.value);\n                      }\n                    })]\n                  }), /*#__PURE__*/_jsxs(Col, {\n                    className: \"align-items-center\",\n                    children: [/*#__PURE__*/_jsx(Label, {\n                      className: \"visually-hidden\",\n                      \"for\": \"examplePassword\",\n                      children: \" \"\n                    }), /*#__PURE__*/_jsx(Button, {\n                      color: \"primary\",\n                      onClick: function onClick() {\n                        return handleSubmitToken();\n                      },\n                      disabled: tokenActive,\n                      children: \"Submit\"\n                    })]\n                  })]\n                })\n              }) : null, tokenActive ? /*#__PURE__*/_jsxs(_Fragment, {\n                children: [/*#__PURE__*/_jsx(\"div\", {\n                  className: \"row justify-content-center mt-5\",\n                  children: /*#__PURE__*/_jsxs(\"h2\", {\n                    children: [\"Jumlah Vote : \", kandidatDipilih.length, \"/\", dataEvent === null || dataEvent === void 0 ? void 0 : dataEvent.quota]\n                  })\n                }), kandidatDipilih.length === (dataEvent === null || dataEvent === void 0 ? void 0 : dataEvent.quota) ? /*#__PURE__*/_jsx(Button, {\n                  className: \"mt-5 my-2\",\n                  onClick: function onClick() {\n                    return handleVote();\n                  },\n                  color: \"success\",\n                  style: {\n                    width: \"100%\"\n                  },\n                  children: \"Submit\"\n                }) : null, /*#__PURE__*/_jsx(\"div\", {\n                  \"class\": \"row row-cols-1 row-cols-md-5 g-2 justify-content-center\",\n                  children: dataKandidat.map(function (item) {\n                    return /*#__PURE__*/_jsxs(Card, {\n                      className: \"my-2 mr-1\",\n                      color: \"dark\",\n                      outline: true,\n                      children: [/*#__PURE__*/_jsx(CardHeader, {\n                        children: /*#__PURE__*/_jsxs(\"div\", {\n                          className: \"row\",\n                          children: [/*#__PURE__*/_jsx(\"div\", {\n                            className: \"col-sm-10\",\n                            children: item.candidate_name\n                          }), /*#__PURE__*/_jsx(\"div\", {\n                            className: \"col-sm-2 justify-content-center\",\n                            children: kandidatDipilih.includes(item.id) ? /*#__PURE__*/_jsx(\"div\", {\n                              style: {\n                                backgroundColor: \"#5cb85c\",\n                                borderRadius: \"100%\",\n                                height: \"30px\",\n                                width: \"30px\"\n                              },\n                              className: \" d-flex align-items-center justify-content-center\",\n                              children: /*#__PURE__*/_jsx(\"i\", {\n                                \"class\": \"fa fa-check\",\n                                style: {\n                                  color: \"white\"\n                                },\n                                \"aria-hidden\": \"true\"\n                              })\n                            }) : null\n                          })]\n                        })\n                      }), (dataEvent === null || dataEvent === void 0 ? void 0 : dataEvent.show_photo) === 1 ? /*#__PURE__*/_jsx(CardImg, {\n                        alt: \"Card image cap\",\n                        src: item.photo_url !== null ? item.photo_url : PlaceholderImage,\n                        top: true,\n                        width: \"100%\",\n                        height: \"350px\",\n                        style: {\n                          objectFit: \"cover\"\n                        }\n                      }) : \"\", /*#__PURE__*/_jsxs(CardBody, {\n                        children: [/*#__PURE__*/_jsx(CardTitle, {\n                          tag: \"h5\"\n                        }), /*#__PURE__*/_jsx(CardText, {}), /*#__PURE__*/_jsx(\"div\", {\n                          className: \"d-flex justify-content-between\",\n                          children: /*#__PURE__*/_jsx(Button, {\n                            onClick: function onClick() {\n                              return hanldePilihKandidat(item.id);\n                            },\n                            color: \"primary\",\n                            disabled: kandidatDipilih.length === (dataEvent === null || dataEvent === void 0 ? void 0 : dataEvent.quota) && !kandidatDipilih.includes(item.id),\n                            style: {\n                              width: \"100%\"\n                            },\n                            children: \"Pilih\"\n                          })\n                        })]\n                      })]\n                    });\n                  })\n                })]\n              }) : null]\n            })]\n          })\n        })\n      })\n    })]\n  });\n}; // User.layout = Admin;\n\n\nexport default User;","map":null,"metadata":{},"sourceType":"module"}